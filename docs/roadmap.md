# yumicuit 開発ロードマップ

## 全体像

```
Phase 1: 最小プロトタイプ
    ↓
Phase 2: AI生成機能
    ↓
Phase 3: 就寝前モード
    ↓
Phase 4: 収益化準備
    ↓
Phase 5: 拡張・改善
```

---

## Phase 1: 最小プロトタイプ

**目標：朝の断片記録ができる最小限のアプリ**

### 1.1 プロジェクトセットアップ

- [ ] SvelteKit プロジェクト作成
- [ ] Capacitor 導入
- [ ] PWA設定（manifest.json, Service Worker）
- [ ] 基本的なルーティング設定

### 1.2 まどろみ記録モード（黒紙UI）

- [ ] 黒背景（#000）+ 白文字（#F5F5F5）のUI
- [ ] 起動時「楽しい？」YES/NO 選択
- [ ] YES → textarea表示
- [ ] 改行で断片を区切る入力
- [ ] 数秒無入力で自動保存
- [ ] 保存後、画面暗転（アプリ終了誘導）

### 1.3 ストレージ

- [ ] IndexedDB セットアップ
- [ ] DreamRecord スキーマ実装
- [ ] 断片保存機能
- [ ] 基本的なCRUD操作

### 1.4 触覚フィードバック

- [ ] Vibration API 対応
- [ ] YES/NOタップ時の振動
- [ ] 保存完了時の振動

### 1.5 起動導線

- [ ] PWA Install 対応
- [ ] ホーム画面アイコン設定（黒背景）
- [ ] スプラッシュスクリーン（最小限、黒）

**完了基準：**
- 朝起きて、黒い画面で断片を入力し、自動保存できる
- オフラインで動作する
- 二度寝できる（アプリが邪魔しない）

---

## Phase 2: AI生成機能

**目標：断片から短編を生成できる**

### 2.1 ローカルLLM導入

- [ ] WebGPU 検出ロジック
- [ ] WebLLM（MLC）統合
- [ ] wllama フォールバック
- [ ] Web Worker での推論実行

### 2.2 モデル管理

- [ ] モデルダウンロードUI
- [ ] 進捗表示
- [ ] CacheStorage/IndexedDB へのキャッシュ
- [ ] モデル削除機能
- [ ] 容量監視（`navigator.storage.estimate()`）

### 2.3 生成機能

- [ ] プロンプトテンプレート実装
- [ ] 短編生成（1案）
- [ ] 3案同時生成
- [ ] ストリーミング表示
- [ ] 生成キャンセル

### 2.4 パラメータ調整

- [ ] 強引さ（force）スライダー
- [ ] 連想方向（focus）選択
- [ ] パラメータ変更して再生成

### 2.5 確定フロー

- [ ] 「こんな夢だった」確定ボタン
- [ ] 確定前の微修正機能
- [ ] storyVersions, confirmedStory 保存

### 2.6 ふりかえりモードUI

- [ ] 昼用の明るいUIテーマ（黒紙ではない）
- [ ] 過去の夢リスト表示
- [ ] 詳細画面（断片 + 生成ストーリー）
- [ ] タグ付け機能（任意）

**完了基準：**
- 昼に過去の断片を見て、AI生成でストーリーを作れる
- 3案から選んで確定できる
- パラメータ調整で再生成できる

---

## Phase 3: 就寝前モード

**目標：再夢のプライミングができる**

### 3.1 夢の種生成

- [ ] キーワード抽出（5-7個）
- [ ] 核の一文生成
- [ ] seeds データ保存

### 3.2 就寝前UI

- [ ] 黒背景維持
- [ ] キーワード列表示
- [ ] 核の一文表示
- [ ] 視覚刺激最小（薄い文字、アニメなし or 極小）
- [ ] スクロールなし（1画面完結）

### 3.3 夢選択

- [ ] 今夜見たい夢を選ぶUI
- [ ] 最近の確定済み夢リスト
- [ ] シンプルなタップ選択

**完了基準：**
- 寝る前に過去の夢を選んで、キーワードと一文を見れる
- 画面が暗く、睡眠導入を妨げない
- 「続きを見たい」と思える

---

## Phase 4: 収益化準備

**目標：Adsense審査に通る準備**

### 4.1 コンテンツページ

- [ ] 夢の科学記事（2-3本）
- [ ] 再夢のテクニック記事（2-3本）
- [ ] 有名事例紹介記事（2-3本）
- [ ] SEO対策（メタタグ、構造化データ）

### 4.2 Adsense準備

- [ ] プライバシーポリシーページ
- [ ] 利用規約ページ
- [ ] お問い合わせ先明記
- [ ] Adsenseアカウント作成

### 4.3 広告実装

- [ ] Adsenseコード埋め込み
- [ ] 昼モードのみに表示制限
- [ ] 広告ブロックの配置調整

### 4.4 分析

- [ ] Google Analytics 導入
- [ ] 基本的なイベントトラッキング
- [ ] ユーザー行動の把握

**完了基準：**
- Adsense審査を通過する
- 昼モードにのみ広告が表示される
- 朝・就寝前は広告ゼロ

---

## Phase 5: 拡張・改善

**目標：ユーザーフィードバックに基づく改善**

### 5.1 UX改善

- [ ] ユーザーフィードバック収集
- [ ] 起動速度の最適化
- [ ] バッテリー消費の最適化

### 5.2 AI改善

- [ ] より良いモデルへの更新
- [ ] 日本語特化モデルの検討
- [ ] 生成品質の向上

### 5.3 機能追加（優先度低）

- [ ] エクスポート機能（JSON）
- [ ] 検索機能
- [ ] 統計機能（昼モードのみ）

### 5.4 ネイティブ化（任意）

- [ ] Capacitorでビルド
- [ ] AdMob統合
- [ ] App Store / Google Play 申請

---

## タイムライン目安

| Phase | 目安期間 | 備考 |
|-------|----------|------|
| Phase 1 | 1-2週間 | 最速で動くものを |
| Phase 2 | 2-3週間 | AI統合が鍵 |
| Phase 3 | 1週間 | UIは軽い |
| Phase 4 | 2-4週間 | コンテンツ作成が主 |
| Phase 5 | 継続的 | フィードバック駆動 |

**注意：タイムラインは目安。品質を優先する。**

---

## 優先順位の原則

1. **朝の体験を最優先**
   - 覚醒させない黒紙UI
   - 自動保存
   - 高速起動

2. **オフライン動作**
   - PWAキャッシュ
   - IndexedDB
   - ローカルLLM

3. **シンプルさ**
   - 機能を増やしすぎない
   - 朝は最小限
   - 複雑さは昼に

4. **プライバシー**
   - ローカル完結
   - 共有機能なし
   - データ送信なし
